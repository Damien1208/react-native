{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getInfoAsync = getInfoAsync;\nexports.readAsStringAsync = readAsStringAsync;\nexports.getContentUriAsync = getContentUriAsync;\nexports.writeAsStringAsync = writeAsStringAsync;\nexports.deleteAsync = deleteAsync;\nexports.moveAsync = moveAsync;\nexports.copyAsync = copyAsync;\nexports.makeDirectoryAsync = makeDirectoryAsync;\nexports.readDirectoryAsync = readDirectoryAsync;\nexports.downloadAsync = downloadAsync;\nexports.createDownloadResumable = createDownloadResumable;\nObject.defineProperty(exports, \"EncodingType\", {\n  enumerable: true,\n  get: function get() {\n    return _FileSystem.EncodingType;\n  }\n});\nexports.DownloadResumable = exports.bundleDirectory = exports.bundledAssets = exports.cacheDirectory = exports.documentDirectory = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _core = require(\"@unimodules/core\");\n\nvar _uuidJs = _interopRequireDefault(require(\"uuid-js\"));\n\nvar _ExponentFileSystem = _interopRequireDefault(require(\"./ExponentFileSystem\"));\n\nvar _Platform = _interopRequireDefault(require(\"react-native-web/dist/exports/Platform\"));\n\nvar _FileSystem = require(\"./FileSystem.types\");\n\nif (!_ExponentFileSystem.default) {\n  console.warn(\"No native ExponentFileSystem module found, are you sure the expo-file-system's module is linked properly?\");\n}\n\nvar _unused = new _core.EventEmitter(_ExponentFileSystem.default);\n\nfunction normalizeEndingSlash(p) {\n  if (p != null) {\n    return p.replace(/\\/*$/, '') + '/';\n  }\n\n  return null;\n}\n\nvar documentDirectory = normalizeEndingSlash(_ExponentFileSystem.default.documentDirectory);\nexports.documentDirectory = documentDirectory;\nvar cacheDirectory = normalizeEndingSlash(_ExponentFileSystem.default.cacheDirectory);\nexports.cacheDirectory = cacheDirectory;\nvar bundledAssets = _ExponentFileSystem.default.bundledAssets,\n    bundleDirectory = _ExponentFileSystem.default.bundleDirectory;\nexports.bundleDirectory = bundleDirectory;\nexports.bundledAssets = bundledAssets;\n\nfunction getInfoAsync(fileUri) {\n  var options,\n      _args = arguments;\n  return _regenerator.default.async(function getInfoAsync$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n\n          if (_ExponentFileSystem.default.getInfoAsync) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'getInfoAsync');\n\n        case 3:\n          _context.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.getInfoAsync(fileUri, options));\n\n        case 5:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n}\n\nfunction readAsStringAsync(fileUri, options) {\n  return _regenerator.default.async(function readAsStringAsync$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          if (_ExponentFileSystem.default.readAsStringAsync) {\n            _context2.next = 2;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'readAsStringAsync');\n\n        case 2:\n          _context2.next = 4;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.readAsStringAsync(fileUri, options || {}));\n\n        case 4:\n          return _context2.abrupt(\"return\", _context2.sent);\n\n        case 5:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n}\n\nfunction getContentUriAsync(fileUri) {\n  return _regenerator.default.async(function getContentUriAsync$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          if (!(_Platform.default.OS === 'android')) {\n            _context3.next = 8;\n            break;\n          }\n\n          if (_ExponentFileSystem.default.getContentUriAsync) {\n            _context3.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'getContentUriAsync');\n\n        case 3:\n          _context3.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.getContentUriAsync(fileUri));\n\n        case 5:\n          return _context3.abrupt(\"return\", _context3.sent);\n\n        case 8:\n          return _context3.abrupt(\"return\", new Promise(function (resolve, reject) {\n            resolve(fileUri);\n          }));\n\n        case 9:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n}\n\nfunction writeAsStringAsync(fileUri, contents) {\n  var options,\n      _args4 = arguments;\n  return _regenerator.default.async(function writeAsStringAsync$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          options = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : {};\n\n          if (_ExponentFileSystem.default.writeAsStringAsync) {\n            _context4.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'writeAsStringAsync');\n\n        case 3:\n          _context4.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.writeAsStringAsync(fileUri, contents, options));\n\n        case 5:\n          return _context4.abrupt(\"return\", _context4.sent);\n\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  });\n}\n\nfunction deleteAsync(fileUri) {\n  var options,\n      _args5 = arguments;\n  return _regenerator.default.async(function deleteAsync$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};\n\n          if (_ExponentFileSystem.default.deleteAsync) {\n            _context5.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'deleteAsync');\n\n        case 3:\n          _context5.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.deleteAsync(fileUri, options));\n\n        case 5:\n          return _context5.abrupt(\"return\", _context5.sent);\n\n        case 6:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  });\n}\n\nfunction moveAsync(options) {\n  return _regenerator.default.async(function moveAsync$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          if (_ExponentFileSystem.default.moveAsync) {\n            _context6.next = 2;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'moveAsync');\n\n        case 2:\n          _context6.next = 4;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.moveAsync(options));\n\n        case 4:\n          return _context6.abrupt(\"return\", _context6.sent);\n\n        case 5:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  });\n}\n\nfunction copyAsync(options) {\n  return _regenerator.default.async(function copyAsync$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          if (_ExponentFileSystem.default.copyAsync) {\n            _context7.next = 2;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'copyAsync');\n\n        case 2:\n          _context7.next = 4;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.copyAsync(options));\n\n        case 4:\n          return _context7.abrupt(\"return\", _context7.sent);\n\n        case 5:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  });\n}\n\nfunction makeDirectoryAsync(fileUri) {\n  var options,\n      _args8 = arguments;\n  return _regenerator.default.async(function makeDirectoryAsync$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          options = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {};\n\n          if (_ExponentFileSystem.default.makeDirectoryAsync) {\n            _context8.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'makeDirectoryAsync');\n\n        case 3:\n          _context8.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.makeDirectoryAsync(fileUri, options));\n\n        case 5:\n          return _context8.abrupt(\"return\", _context8.sent);\n\n        case 6:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  });\n}\n\nfunction readDirectoryAsync(fileUri) {\n  return _regenerator.default.async(function readDirectoryAsync$(_context9) {\n    while (1) {\n      switch (_context9.prev = _context9.next) {\n        case 0:\n          if (_ExponentFileSystem.default.readDirectoryAsync) {\n            _context9.next = 2;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'readDirectoryAsync');\n\n        case 2:\n          _context9.next = 4;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.readDirectoryAsync(fileUri, {}));\n\n        case 4:\n          return _context9.abrupt(\"return\", _context9.sent);\n\n        case 5:\n        case \"end\":\n          return _context9.stop();\n      }\n    }\n  });\n}\n\nfunction downloadAsync(uri, fileUri) {\n  var options,\n      _args10 = arguments;\n  return _regenerator.default.async(function downloadAsync$(_context10) {\n    while (1) {\n      switch (_context10.prev = _context10.next) {\n        case 0:\n          options = _args10.length > 2 && _args10[2] !== undefined ? _args10[2] : {};\n\n          if (_ExponentFileSystem.default.downloadAsync) {\n            _context10.next = 3;\n            break;\n          }\n\n          throw new _core.UnavailabilityError('expo-file-system', 'downloadAsync');\n\n        case 3:\n          _context10.next = 5;\n          return _regenerator.default.awrap(_ExponentFileSystem.default.downloadAsync(uri, fileUri, options));\n\n        case 5:\n          return _context10.abrupt(\"return\", _context10.sent);\n\n        case 6:\n        case \"end\":\n          return _context10.stop();\n      }\n    }\n  });\n}\n\nfunction createDownloadResumable(uri, fileUri, options, callback, resumeData) {\n  return new DownloadResumable(uri, fileUri, options, callback, resumeData);\n}\n\nvar DownloadResumable = function () {\n  function DownloadResumable(url, fileUri) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var callback = arguments.length > 3 ? arguments[3] : undefined;\n    var resumeData = arguments.length > 4 ? arguments[4] : undefined;\n    (0, _classCallCheck2.default)(this, DownloadResumable);\n    this._uuid = _uuidJs.default.create(4).toString();\n    this._url = url;\n    this._fileUri = fileUri;\n    this._options = options;\n    this._resumeData = resumeData;\n    this._callback = callback;\n    this._subscription = null;\n    this._emitter = new _core.EventEmitter(_ExponentFileSystem.default);\n  }\n\n  (0, _createClass2.default)(DownloadResumable, [{\n    key: \"downloadAsync\",\n    value: function downloadAsync() {\n      return _regenerator.default.async(function downloadAsync$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              if (_ExponentFileSystem.default.downloadResumableStartAsync) {\n                _context11.next = 2;\n                break;\n              }\n\n              throw new _core.UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n\n            case 2:\n              this._addSubscription();\n\n              _context11.next = 5;\n              return _regenerator.default.awrap(_ExponentFileSystem.default.downloadResumableStartAsync(this._url, this._fileUri, this._uuid, this._options, this._resumeData));\n\n            case 5:\n              return _context11.abrupt(\"return\", _context11.sent);\n\n            case 6:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"pauseAsync\",\n    value: function pauseAsync() {\n      var pauseResult;\n      return _regenerator.default.async(function pauseAsync$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              if (_ExponentFileSystem.default.downloadResumablePauseAsync) {\n                _context12.next = 2;\n                break;\n              }\n\n              throw new _core.UnavailabilityError('expo-file-system', 'downloadResumablePauseAsync');\n\n            case 2:\n              _context12.next = 4;\n              return _regenerator.default.awrap(_ExponentFileSystem.default.downloadResumablePauseAsync(this._uuid));\n\n            case 4:\n              pauseResult = _context12.sent;\n\n              this._removeSubscription();\n\n              if (!pauseResult) {\n                _context12.next = 11;\n                break;\n              }\n\n              this._resumeData = pauseResult.resumeData;\n              return _context12.abrupt(\"return\", this.savable());\n\n            case 11:\n              throw new Error('Unable to generate a savable pause state');\n\n            case 12:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"resumeAsync\",\n    value: function resumeAsync() {\n      return _regenerator.default.async(function resumeAsync$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              if (_ExponentFileSystem.default.downloadResumableStartAsync) {\n                _context13.next = 2;\n                break;\n              }\n\n              throw new _core.UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n\n            case 2:\n              this._addSubscription();\n\n              _context13.next = 5;\n              return _regenerator.default.awrap(_ExponentFileSystem.default.downloadResumableStartAsync(this._url, this._fileUri, this._uuid, this._options, this._resumeData));\n\n            case 5:\n              return _context13.abrupt(\"return\", _context13.sent);\n\n            case 6:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"savable\",\n    value: function savable() {\n      return {\n        url: this._url,\n        fileUri: this._fileUri,\n        options: this._options,\n        resumeData: this._resumeData\n      };\n    }\n  }, {\n    key: \"_addSubscription\",\n    value: function _addSubscription() {\n      var _this = this;\n\n      if (this._subscription) {\n        return;\n      }\n\n      this._subscription = this._emitter.addListener('Exponent.downloadProgress', function (event) {\n        if (event.uuid === _this._uuid) {\n          var callback = _this._callback;\n\n          if (callback) {\n            callback(event.data);\n          }\n        }\n      });\n    }\n  }, {\n    key: \"_removeSubscription\",\n    value: function _removeSubscription() {\n      if (!this._subscription) {\n        return;\n      }\n\n      this._emitter.removeSubscription(this._subscription);\n\n      this._subscription = null;\n    }\n  }]);\n  return DownloadResumable;\n}();\n\nexports.DownloadResumable = DownloadResumable;","map":{"version":3,"sources":["../src/FileSystem.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;AACA;;;;AAGA;;AAaA,IAAI,CAAC,2BAAL,EAAyB;AACvB,EAAA,OAAO,CAAC,IAAR,CACE,2GADF;AAGD;;AAED,IAAM,OAAO,GAAG,IAAI,kBAAJ,CAAiB,2BAAjB,CAAhB;;AAeA,SAAS,oBAAT,CAA8B,CAA9B,EAA8C;AAC5C,MAAI,CAAC,IAAI,IAAT,EAAe;AACb,WAAO,CAAC,CAAC,OAAF,CAAU,MAAV,EAAkB,EAAlB,IAAwB,GAA/B;AACD;;AACD,SAAO,IAAP;AACD;;AAEM,IAAM,iBAAiB,GAAG,oBAAoB,CAAC,4BAAmB,iBAApB,CAA9C;;AACA,IAAM,cAAc,GAAG,oBAAoB,CAAC,4BAAmB,cAApB,CAA3C;;IAEQ,a,GAAmC,2B,CAAnC,a;IAAe,e,GAAoB,2B,CAApB,e;;;;AAEvB,SAAe,YAAf,CACL,OADK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEL,UAAA,OAFK,2DAEwC,EAFxC;;AAAA,cAIA,4BAAmB,YAJnB;AAAA;AAAA;AAAA;;AAAA,gBAKG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,cAA5C,CALH;;AAAA;AAAA;AAAA,4CAOQ,4BAAmB,YAAnB,CAAgC,OAAhC,EAAyC,OAAzC,CAPR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUA,SAAe,iBAAf,CACL,OADK,EAEL,OAFK;AAAA;AAAA;AAAA;AAAA;AAAA,cAIA,4BAAmB,iBAJnB;AAAA;AAAA;AAAA;;AAAA,gBAKG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,mBAA5C,CALH;;AAAA;AAAA;AAAA,4CAOQ,4BAAmB,iBAAnB,CAAqC,OAArC,EAA8C,OAAO,IAAI,EAAzD,CAPR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUA,SAAe,kBAAf,CAAkC,OAAlC;AAAA;AAAA;AAAA;AAAA;AAAA,gBACD,kBAAS,EAAT,KAAgB,SADf;AAAA;AAAA;AAAA;;AAAA,cAEE,4BAAmB,kBAFrB;AAAA;AAAA;AAAA;;AAAA,gBAGK,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,oBAA5C,CAHL;;AAAA;AAAA;AAAA,4CAKU,4BAAmB,kBAAnB,CAAsC,OAAtC,CALV;;AAAA;AAAA;;AAAA;AAAA,4CAOI,IAAI,OAAJ,CAAY,UAAS,OAAT,EAAkB,MAAlB,EAAwB;AACzC,YAAA,OAAO,CAAC,OAAD,CAAP;AACD,WAFM,CAPJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAaA,SAAe,kBAAf,CACL,OADK,EAEL,QAFK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGL,UAAA,OAHK,8DAGqB,EAHrB;;AAAA,cAKA,4BAAmB,kBALnB;AAAA;AAAA;AAAA;;AAAA,gBAMG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,oBAA5C,CANH;;AAAA;AAAA;AAAA,4CAQQ,4BAAmB,kBAAnB,CAAsC,OAAtC,EAA+C,QAA/C,EAAyD,OAAzD,CARR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAWA,SAAe,WAAf,CACL,OADK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEL,UAAA,OAFK,8DAE+B,EAF/B;;AAAA,cAIA,4BAAmB,WAJnB;AAAA;AAAA;AAAA;;AAAA,gBAKG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,aAA5C,CALH;;AAAA;AAAA;AAAA,4CAOQ,4BAAmB,WAAnB,CAA+B,OAA/B,EAAwC,OAAxC,CAPR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUA,SAAe,SAAf,CAAyB,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,cACA,4BAAmB,SADnB;AAAA;AAAA;AAAA;;AAAA,gBAEG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,WAA5C,CAFH;;AAAA;AAAA;AAAA,4CAIQ,4BAAmB,SAAnB,CAA6B,OAA7B,CAJR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOA,SAAe,SAAf,CAAyB,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,cACA,4BAAmB,SADnB;AAAA;AAAA;AAAA;;AAAA,gBAEG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,WAA5C,CAFH;;AAAA;AAAA;AAAA,4CAIQ,4BAAmB,SAAnB,CAA6B,OAA7B,CAJR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOA,SAAe,kBAAf,CACL,OADK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEL,UAAA,OAFK,8DAEkC,EAFlC;;AAAA,cAIA,4BAAmB,kBAJnB;AAAA;AAAA;AAAA;;AAAA,gBAKG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,oBAA5C,CALH;;AAAA;AAAA;AAAA,4CAOQ,4BAAmB,kBAAnB,CAAsC,OAAtC,EAA+C,OAA/C,CAPR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUA,SAAe,kBAAf,CAAkC,OAAlC;AAAA;AAAA;AAAA;AAAA;AAAA,cACA,4BAAmB,kBADnB;AAAA;AAAA;AAAA;;AAAA,gBAEG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,oBAA5C,CAFH;;AAAA;AAAA;AAAA,4CAIQ,4BAAmB,kBAAnB,CAAsC,OAAtC,EAA+C,EAA/C,CAJR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOA,SAAe,aAAf,CACL,GADK,EAEL,OAFK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGL,UAAA,OAHK,iEAGsB,EAHtB;;AAAA,cAKA,4BAAmB,aALnB;AAAA;AAAA;AAAA;;AAAA,gBAMG,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,eAA5C,CANH;;AAAA;AAAA;AAAA,4CAQQ,4BAAmB,aAAnB,CAAiC,GAAjC,EAAsC,OAAtC,EAA+C,OAA/C,CARR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAWD,SAAU,uBAAV,CACJ,GADI,EAEJ,OAFI,EAGJ,OAHI,EAIJ,QAJI,EAKJ,UALI,EAKe;AAEnB,SAAO,IAAI,iBAAJ,CAAsB,GAAtB,EAA2B,OAA3B,EAAoC,OAApC,EAA6C,QAA7C,EAAuD,UAAvD,CAAP;AACD;;IAEY,iB;AAUX,6BACE,GADF,EAEE,OAFF,EAKqB;AAAA,QAFnB,OAEmB,uEAFQ,EAER;AAAA,QADnB,QACmB;AAAA,QAAnB,UAAmB;AAAA;AAEnB,SAAK,KAAL,GAAa,gBAAK,MAAL,CAAY,CAAZ,EAAe,QAAf,EAAb;AACA,SAAK,IAAL,GAAY,GAAZ;AACA,SAAK,QAAL,GAAgB,OAAhB;AACA,SAAK,QAAL,GAAgB,OAAhB;AACA,SAAK,WAAL,GAAmB,UAAnB;AACA,SAAK,SAAL,GAAiB,QAAjB;AACA,SAAK,aAAL,GAAqB,IAArB;AACA,SAAK,QAAL,GAAgB,IAAI,kBAAJ,CAAiB,2BAAjB,CAAhB;AACD;;;;;;;;;kBAGM,4BAAmB,2B;;;;;oBAChB,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,6BAA5C,C;;;AAER,mBAAK,gBAAL;;;gDACa,4BAAmB,2BAAnB,CACX,KAAK,IADM,EAEX,KAAK,QAFM,EAGX,KAAK,KAHM,EAIX,KAAK,QAJM,EAKX,KAAK,WALM,C;;;;;;;;;;;;;;;;;;;;kBAUR,4BAAmB,2B;;;;;oBAChB,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,6BAA5C,C;;;;gDAEkB,4BAAmB,2BAAnB,CAA+C,KAAK,KAApD,C;;;AAApB,cAAA,W;;AACN,mBAAK,mBAAL;;mBACI,W;;;;;AACF,mBAAK,WAAL,GAAmB,WAAW,CAAC,UAA/B;iDACO,KAAK,OAAL,E;;;oBAED,IAAI,KAAJ,CAAU,0CAAV,C;;;;;;;;;;;;;;;;kBAKH,4BAAmB,2B;;;;;oBAChB,IAAI,yBAAJ,CAAwB,kBAAxB,EAA4C,6BAA5C,C;;;AAER,mBAAK,gBAAL;;;gDACa,4BAAmB,2BAAnB,CACX,KAAK,IADM,EAEX,KAAK,QAFM,EAGX,KAAK,KAHM,EAIX,KAAK,QAJM,EAKX,KAAK,WALM,C;;;;;;;;;;;;;;8BASR;AACL,aAAO;AACL,QAAA,GAAG,EAAE,KAAK,IADL;AAEL,QAAA,OAAO,EAAE,KAAK,QAFT;AAGL,QAAA,OAAO,EAAE,KAAK,QAHT;AAIL,QAAA,UAAU,EAAE,KAAK;AAJZ,OAAP;AAMD;;;uCAEe;AAAA;;AACd,UAAI,KAAK,aAAT,EAAwB;AACtB;AACD;;AACD,WAAK,aAAL,GAAqB,KAAK,QAAL,CAAc,WAAd,CACnB,2BADmB,EAEnB,UAAC,KAAD,EAAyB;AACvB,YAAI,KAAK,CAAC,IAAN,KAAe,KAAI,CAAC,KAAxB,EAA+B;AAC7B,cAAM,QAAQ,GAAG,KAAI,CAAC,SAAtB;;AACA,cAAI,QAAJ,EAAc;AACZ,YAAA,QAAQ,CAAC,KAAK,CAAC,IAAP,CAAR;AACD;AACF;AACF,OATkB,CAArB;AAWD;;;0CAEkB;AACjB,UAAI,CAAC,KAAK,aAAV,EAAyB;AACvB;AACD;;AACD,WAAK,QAAL,CAAc,kBAAd,CAAiC,KAAK,aAAtC;;AACA,WAAK,aAAL,GAAqB,IAArB;AACD","sourcesContent":["import { UnavailabilityError } from '@unimodules/core';\nimport { EventEmitter, Subscription } from '@unimodules/core';\nimport UUID from 'uuid-js';\nimport ExponentFileSystem from './ExponentFileSystem';\nimport { Platform } from 'react-native';\n\nimport {\n  DownloadOptions,\n  DownloadResult,\n  DownloadProgressCallback,\n  DownloadProgressData,\n  DownloadPauseState,\n  FileInfo,\n  EncodingType,\n  ReadingOptions,\n  WritingOptions,\n  ProgressEvent,\n} from './FileSystem.types';\n\nif (!ExponentFileSystem) {\n  console.warn(\n    \"No native ExponentFileSystem module found, are you sure the expo-file-system's module is linked properly?\"\n  );\n}\n// Prevent webpack from pruning this.\nconst _unused = new EventEmitter(ExponentFileSystem);\n\nexport {\n  DownloadOptions,\n  DownloadResult,\n  DownloadProgressCallback,\n  DownloadProgressData,\n  DownloadPauseState,\n  FileInfo,\n  EncodingType,\n  ReadingOptions,\n  WritingOptions,\n  ProgressEvent,\n};\n\nfunction normalizeEndingSlash(p: string | null): string | null {\n  if (p != null) {\n    return p.replace(/\\/*$/, '') + '/';\n  }\n  return null;\n}\n\nexport const documentDirectory = normalizeEndingSlash(ExponentFileSystem.documentDirectory);\nexport const cacheDirectory = normalizeEndingSlash(ExponentFileSystem.cacheDirectory);\n\nexport const { bundledAssets, bundleDirectory } = ExponentFileSystem;\n\nexport async function getInfoAsync(\n  fileUri: string,\n  options: { md5?: boolean; size?: boolean } = {}\n): Promise<FileInfo> {\n  if (!ExponentFileSystem.getInfoAsync) {\n    throw new UnavailabilityError('expo-file-system', 'getInfoAsync');\n  }\n  return await ExponentFileSystem.getInfoAsync(fileUri, options);\n}\n\nexport async function readAsStringAsync(\n  fileUri: string,\n  options?: ReadingOptions\n): Promise<string> {\n  if (!ExponentFileSystem.readAsStringAsync) {\n    throw new UnavailabilityError('expo-file-system', 'readAsStringAsync');\n  }\n  return await ExponentFileSystem.readAsStringAsync(fileUri, options || {});\n}\n\nexport async function getContentUriAsync(fileUri: string): Promise<string> {\n  if (Platform.OS === 'android') {\n    if (!ExponentFileSystem.getContentUriAsync) {\n      throw new UnavailabilityError('expo-file-system', 'getContentUriAsync');\n    }\n    return await ExponentFileSystem.getContentUriAsync(fileUri);\n  } else {\n    return new Promise(function(resolve, reject) {\n      resolve(fileUri);\n    });\n  }\n}\n\nexport async function writeAsStringAsync(\n  fileUri: string,\n  contents: string,\n  options: WritingOptions = {}\n): Promise<void> {\n  if (!ExponentFileSystem.writeAsStringAsync) {\n    throw new UnavailabilityError('expo-file-system', 'writeAsStringAsync');\n  }\n  return await ExponentFileSystem.writeAsStringAsync(fileUri, contents, options);\n}\n\nexport async function deleteAsync(\n  fileUri: string,\n  options: { idempotent?: boolean } = {}\n): Promise<void> {\n  if (!ExponentFileSystem.deleteAsync) {\n    throw new UnavailabilityError('expo-file-system', 'deleteAsync');\n  }\n  return await ExponentFileSystem.deleteAsync(fileUri, options);\n}\n\nexport async function moveAsync(options: { from: string; to: string }): Promise<void> {\n  if (!ExponentFileSystem.moveAsync) {\n    throw new UnavailabilityError('expo-file-system', 'moveAsync');\n  }\n  return await ExponentFileSystem.moveAsync(options);\n}\n\nexport async function copyAsync(options: { from: string; to: string }): Promise<void> {\n  if (!ExponentFileSystem.copyAsync) {\n    throw new UnavailabilityError('expo-file-system', 'copyAsync');\n  }\n  return await ExponentFileSystem.copyAsync(options);\n}\n\nexport async function makeDirectoryAsync(\n  fileUri: string,\n  options: { intermediates?: boolean } = {}\n): Promise<void> {\n  if (!ExponentFileSystem.makeDirectoryAsync) {\n    throw new UnavailabilityError('expo-file-system', 'makeDirectoryAsync');\n  }\n  return await ExponentFileSystem.makeDirectoryAsync(fileUri, options);\n}\n\nexport async function readDirectoryAsync(fileUri: string): Promise<string[]> {\n  if (!ExponentFileSystem.readDirectoryAsync) {\n    throw new UnavailabilityError('expo-file-system', 'readDirectoryAsync');\n  }\n  return await ExponentFileSystem.readDirectoryAsync(fileUri, {});\n}\n\nexport async function downloadAsync(\n  uri: string,\n  fileUri: string,\n  options: DownloadOptions = {}\n): Promise<DownloadResult> {\n  if (!ExponentFileSystem.downloadAsync) {\n    throw new UnavailabilityError('expo-file-system', 'downloadAsync');\n  }\n  return await ExponentFileSystem.downloadAsync(uri, fileUri, options);\n}\n\nexport function createDownloadResumable(\n  uri: string,\n  fileUri: string,\n  options?: DownloadOptions,\n  callback?: DownloadProgressCallback,\n  resumeData?: string\n): DownloadResumable {\n  return new DownloadResumable(uri, fileUri, options, callback, resumeData);\n}\n\nexport class DownloadResumable {\n  _uuid: string;\n  _url: string;\n  _fileUri: string;\n  _options: DownloadOptions;\n  _resumeData?: string;\n  _callback?: DownloadProgressCallback;\n  _subscription?: Subscription | null;\n  _emitter: EventEmitter;\n\n  constructor(\n    url: string,\n    fileUri: string,\n    options: DownloadOptions = {},\n    callback?: DownloadProgressCallback,\n    resumeData?: string\n  ) {\n    this._uuid = UUID.create(4).toString();\n    this._url = url;\n    this._fileUri = fileUri;\n    this._options = options;\n    this._resumeData = resumeData;\n    this._callback = callback;\n    this._subscription = null;\n    this._emitter = new EventEmitter(ExponentFileSystem);\n  }\n\n  async downloadAsync(): Promise<DownloadResult | undefined> {\n    if (!ExponentFileSystem.downloadResumableStartAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n    }\n    this._addSubscription();\n    return await ExponentFileSystem.downloadResumableStartAsync(\n      this._url,\n      this._fileUri,\n      this._uuid,\n      this._options,\n      this._resumeData\n    );\n  }\n\n  async pauseAsync(): Promise<DownloadPauseState> {\n    if (!ExponentFileSystem.downloadResumablePauseAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumablePauseAsync');\n    }\n    const pauseResult = await ExponentFileSystem.downloadResumablePauseAsync(this._uuid);\n    this._removeSubscription();\n    if (pauseResult) {\n      this._resumeData = pauseResult.resumeData;\n      return this.savable();\n    } else {\n      throw new Error('Unable to generate a savable pause state');\n    }\n  }\n\n  async resumeAsync(): Promise<DownloadResult | undefined> {\n    if (!ExponentFileSystem.downloadResumableStartAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n    }\n    this._addSubscription();\n    return await ExponentFileSystem.downloadResumableStartAsync(\n      this._url,\n      this._fileUri,\n      this._uuid,\n      this._options,\n      this._resumeData\n    );\n  }\n\n  savable(): DownloadPauseState {\n    return {\n      url: this._url,\n      fileUri: this._fileUri,\n      options: this._options,\n      resumeData: this._resumeData,\n    };\n  }\n\n  _addSubscription(): void {\n    if (this._subscription) {\n      return;\n    }\n    this._subscription = this._emitter.addListener(\n      'Exponent.downloadProgress',\n      (event: ProgressEvent) => {\n        if (event.uuid === this._uuid) {\n          const callback = this._callback;\n          if (callback) {\n            callback(event.data);\n          }\n        }\n      }\n    );\n  }\n\n  _removeSubscription(): void {\n    if (!this._subscription) {\n      return;\n    }\n    this._emitter.removeSubscription(this._subscription);\n    this._subscription = null;\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}